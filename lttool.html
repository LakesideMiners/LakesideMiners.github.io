<!DOCTYPE html>
<html lang="en">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300italic,700,700italic">

<!-- CSS Reset -->
<link rel="stylesheet" href="./css/normalize.css">

<!-- Milligram CSS -->
<link rel="stylesheet" href="./css/mill.css">
<script data-goatcounter="https://redsserver.goatcounter.com/count"
        async src="//gc.zgo.at/count.js"></script>
<script src=" https://cdn.jsdelivr.net/npm/js-cookie@3.0.5/dist/js.cookie.min.js "></script>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta charset="UTF-8">
  <meta name="description" content="Fight Calculator and Tracker for the TCG Game Little Troubles">
  <title>Little Troubles Fight Calculator</title>
  <style>
    /* Keep cookie/fight controls compact and adjacent to their value fields */
    .row.controls {
      display: flex;
      flex-direction: row; /* force row so buttons sit next to the input on small screens too */
      align-items: center;
      justify-content: center; /* center the whole control group horizontally */
      gap: 0.4rem;
      flex-wrap: wrap;
      margin-bottom: 0.6rem;
      width: 100%;
    }

    .row.controls .column {
      flex: 0 0 auto;
      width: auto;
      padding: 0 .25rem;
      display: flex;
      align-items: center; /* vertically center button + input content */
      justify-content: center;
      gap: 0.25rem;
    }

    .row.controls .column input[type="number"] {
      width: 6.0rem;
      text-align: center; /* center the numeric value inside the field */
    }

    /* center the Cookies / Fights headings above their controls */
    .controls-heading {
      text-align: center;
      width: 100%;
      margin: 0.6rem 0 0.3rem;
      font-weight: 700;
    }

    /* Result text: responsive, preserve line breaks, and always fit width */
    #result {
      white-space: pre-wrap;            /* keep newlines from JS */
      word-break: break-word;
      overflow-wrap: break-word;
      text-align: center;
      box-sizing: border-box;
      padding: 0 1rem;                  /* prevent touching the edges on small screens */
      line-height: 1.35;
      margin: 0.6rem 0;
      /* Responsive font size: scales with viewport but stays within min/max bounds */
      font-size: clamp(1.0rem, 2.2vw + 0.5rem, 2.0rem);
    }

    /* ensure control rows remain centered on very small screens */
    @media (max-width: 40rem) {
      .row.controls {
        justify-content: center;
      }
    }
  </style>
</head>


<body>
  <div class="container">
    <div class="row">
      <h3>Little Troubles Fight Calculator by Red!</h3>
    </div>
    <div class="row">
      <small>This Site Uses cookies ONLY to store the fight count and cookie count! They expire after 7 days!<a href="https://github.com/LakesideMiners/LakesideMiners.github.io/blob/master/lttool.html"> Source Code!</a></small>
    </div>
    <!--Calc Inputs/Controls-->
    <!--You-->
    <div class="row">
      <h3 class="column">YOU</h3>
    </div>
    <div class="row">
      <!--Confidence-->
      <div class="column"> <label>Confidence (RED)</label>
        <input type="number" id="conf1">
      </div>
      <!--Maturity-->
      <div class="column"> <label>Maturity (BLUE)</label>
        <input type="number" id="mat1">
      </div>
    </div>
    <!--Opponent-->
    <div class="row">
      <h3 class="column">Opponent</h3>
    </div>
    <div class="row">
      <div class="column"> <label>Confidence (RED)</label>
        <input type="number" id="conf2">
      </div>
      <!--Maturity-->
      <div class="column"> <label>Maturity (BLUE)</label>
        <input type="number" id="mat2">
      </div>
    </div>
    <!--fuck css and everything it stands for-->
    <div class="row">
      <div class="column"><button onclick="compareFight()">Compare Fight</button></div>
      <div class="column"><button onclick="resetFightThing()">Reset</button></div>
    </div>
    <h1 id="result"></h1>
    <h4 class="controls-heading">Cookies</h4>
    <div class="row controls">
      <div class="column"><button onclick="adjustCookieValue(-5)">-5</button></div>
      <div class="column"><button onclick="adjustCookieValue(-1)">-1</button></div>
      <div class="column"><input type="number" id="cookies" value="0"></div>
      <div class="column"><button onclick="adjustCookieValue(1)">+1</button></div>
      <div class="column"><button onclick="adjustCookieValue(5)">+5</button></div>
    </div>
    <h4 class="controls-heading">Fights</h4>
    <div class="row controls">
      <div class="column"><button onclick="adjustFightValue(-1)">-1</button></div>
      <div class="column"><input type="number" id="fights" value="0"></div>
      <div class="column"><button onclick="adjustFightValue(1)">+1</button></div>
    </div>
  </div>

<script>
    function adjustCookieValue(value){
      cookies.stepUp(value);
      Cookies.set('cookieSave', parseInt(document.getElementById("cookies").value), { expires: 7 });
    }
    function adjustFightValue(value){
      fights.stepUp(value);
      Cookies.set('fightSave', parseInt(document.getElementById("fights").value), { expires: 7 });
    }
    function loadCookies(){
      console.log("What")
      let fightCookie = Cookies.get('fightSave'); // => 'value'
      console.log(fightCookie);
      let cookieCookie = Cookies.get('cookieSave'); // => 'value'
      console.log(cookieCookie);
      console.log("OWO");

    }
    function compareFight() {
      const conf1 = parseInt(document.getElementById("conf1").value) || 0;
      const mat1 = parseInt(document.getElementById("mat1").value) || 0;
      const conf2 = parseInt(document.getElementById("conf2").value) || 0;
      const mat2 = parseInt(document.getElementById("mat2").value) || 0;

      const char1BeatsChar2 = conf1 >= mat2;
      const char2BeatsChar1 = conf2 >= mat1;

      let outcome = "";
      if (!char1BeatsChar2 && !char2BeatsChar1) {
        outcome = "1. This Fight is a Tie. No regression, timeout, or rewards.";
      } else if (char1BeatsChar2 && !char2BeatsChar1) {
        outcome = "1. You Win!\n2. Your opponent is regressed/sent to Timeout.\n3. You gain your opponent's reward.";
      } else if (!char1BeatsChar2 && char2BeatsChar1) {
        outcome = "1. Your Opponent Wins!\n2. You are regressed/sent to Timeout.\n3. Your Opponent gains your reward.";
      } else {
        outcome = "1. Both of you Win and Lose!\n2. Both are regressed/sent to Timeout.\n3. Each receives the otherâ€™s reward.";
      }
      document.getElementById("result").innerText = outcome;
    }
    function resetFightThing() {
      var mat1V = document.getElementById('mat1');
      var mat2V = document.getElementById('mat2');
      var conf1V = document.getElementById('conf1');
      var conf2V = document.getElementById('conf2');
      var resultV = document.getElementById('result');
      mat1V.value = null;
      mat2V.value = null;
      conf1V.value = null;
      conf2V.value = null;
      resultV.value = null;
    }
    document.addEventListener('DOMContentLoaded', function() {
      loadCookies();
    }, false);
  </script>
</body>
